# CS2 地图 Ban Pick 工具 - 开发环境配置文件

## 1. 项目根目录配置文件

### 1.1 .gitignore

```gitignore
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
venv/
ENV/
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg

# Node
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
dist/
dist-ssr/
*.local

# IDE
.vscode/
.idea/
*.swp
*.swo
*~
.DS_Store

# Environment
.env
.env.local
.env.*.local

# Docker
*.log

# Database
*.db
*.sqlite
*.sqlite3

# SSL
nginx/ssl/*.pem
nginx/ssl/*.key

# Logs
logs/
*.log

# OS
Thumbs.db
```

### 1.2 README.md

```markdown
# CS2 地图 Ban Pick 工具

一个用于 Counter-Strike 2 的地图 Ban Pick 工具，支持 BO3 模式的地图禁用和选择流程。

## 技术栈

- 前端：Vue.js 3 + Vite + TailwindCSS
- 后端：Python FastAPI + Socket.io
- 数据库：PostgreSQL
- 部署：Docker + Docker Compose

## 快速开始

### 使用 Docker（推荐）

```bash
# 开发环境
docker-compose -f docker-compose.dev.yml up

# 生产环境
docker-compose up -d
```

### 本地开发

#### 前端开发

```bash
cd frontend
npm install
npm run dev
```

#### 后端开发

```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
uvicorn app.main:app --reload
```

## 文档

- [项目整体架构设计](./plans/01-项目整体架构设计.md)
- [数据库模型设计](./plans/02-数据库模型设计.md)
- [后端API接口规范](./plans/03-后端API接口规范.md)
- [前端页面结构和组件架构](./plans/04-前端页面结构和组件架构.md)
- [项目目录结构](./plans/05-项目目录结构.md)
- [Docker配置文件](./plans/06-Docker配置文件.md)

## 许可证

MIT
```

## 2. 前端配置文件

### 2.1 package.json

```json
{
  "name": "cs2-ban-pick-frontend",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext .vue,.js,.jsx,.cjs,.mjs,.ts,.tsx,.cts,.mts --fix --ignore-path .gitignore",
    "test": "vitest"
  },
  "dependencies": {
    "vue": "^3.4.0",
    "vue-router": "^4.2.0",
    "pinia": "^2.1.0",
    "axios": "^1.6.0",
    "socket.io-client": "^4.6.0"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^5.0.0",
    "@vue/tsconfig": "^0.5.0",
    "typescript": "^5.3.0",
    "vite": "^5.0.0",
    "vue-tsc": "^1.8.0",
    "tailwindcss": "^3.4.0",
    "postcss": "^8.4.0",
    "autoprefixer": "^10.4.0",
    "eslint": "^8.55.0",
    "eslint-plugin-vue": "^9.19.0",
    "@typescript-eslint/eslint-plugin": "^6.15.0",
    "@typescript-eslint/parser": "^6.15.0",
    "vitest": "^1.0.0"
  }
}
```

### 2.2 vite.config.ts

```typescript
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import path from 'path';

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  server: {
    host: '0.0.0.0',
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true,
      },
      '/socket.io': {
        target: 'http://localhost:8000',
        changeOrigin: true,
        ws: true,
      },
    },
  },
});
```

### 2.3 tailwind.config.js

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{vue,js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: '#f59e0b',
        secondary: '#3b82f6',
        success: '#10b981',
        danger: '#ef4444',
        warning: '#f59e0b',
      },
      fontFamily: {
        sans: ['Inter', 'sans-serif'],
      },
    },
  },
  plugins: [],
}
```

### 2.4 tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "preserve",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,

    /* Path mapping */
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src/**/*.ts", "src/**/*.d.ts", "src/**/*.tsx", "src/**/*.vue"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

### 2.5 tsconfig.node.json

```json
{
  "compilerOptions": {
    "composite": true,
    "skipLibCheck": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "allowSyntheticDefaultImports": true
  },
  "include": ["vite.config.ts"]
}
```

### 2.6 .env.example

```env
VITE_API_BASE_URL=http://localhost:8000/api
VITE_WS_BASE_URL=http://localhost:8000
```

## 3. 后端配置文件

### 3.1 requirements.txt

```txt
# Web Framework
fastapi==0.109.0
uvicorn[standard]==0.27.0
python-multipart==0.0.6

# WebSocket
python-socketio==5.11.0
aiohttp==3.9.1

# Database
sqlalchemy==2.0.25
psycopg2-binary==2.9.9
alembic==1.13.1

# Authentication
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4

# Validation
pydantic==2.5.3
pydantic-settings==2.1.0
email-validator==2.1.0

# Utilities
python-dotenv==1.0.0
orjson==3.9.12
```

### 3.2 requirements-dev.txt

```txt
-r requirements.txt

# Testing
pytest==7.4.4
pytest-asyncio==0.23.3
httpx==0.26.0

# Code Quality
black==23.12.1
isort==5.13.2
flake8==7.0.0
mypy==1.8.0

# Type Stubs
types-passlib==1.7.7.13
types-python-jose==3.3.0.20240106
```

### 3.3 pyproject.toml

```toml
[project]
name = "cs2-ban-pick-backend"
version = "1.0.0"
description = "CS2 Map Ban Pick Tool Backend"
requires-python = ">=3.11"

[tool.black]
line-length = 100
target-version = ['py311']

[tool.isort]
profile = "black"
line_length = 100

[tool.mypy]
python_version = "3.11"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
plugins = ["pydantic.mypy"]

[tool.pytest.ini_options]
asyncio_mode = "auto"
testpaths = ["tests"]
```

### 3.4 .env.example

```env
# Application
APP_NAME=CS2 Map Ban Pick Tool
APP_VERSION=1.0.0
DEBUG=True

# Database
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/cs2_bp_tool

# Redis
REDIS_URL=redis://localhost:6379/0

# JWT
SECRET_KEY=your-secret-key-change-this-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=60

# CORS
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# WebSocket
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
```

### 3.5 alembic.ini

```ini
# Alembic Configuration File

[alembic]
script_location = alembic
file_template = %%(year)d%%(month).2d%%(day).2d_%%(hour).2d%%(minute).2d_%%(rev)s_%%(slug)s
sqlalchemy.url = postgresql://postgres:postgres@localhost:5432/cs2_bp_tool

[post_write_hooks]

[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers =
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S
```

## 4. VSCode 配置

### 4.1 .vscode/settings.json

```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true,
    "source.organizeImports": true
  },
  "python.defaultInterpreterPath": "./backend/venv/bin/python",
  "python.linting.enabled": true,
  "python.linting.flake8Enabled": true,
  "python.formatting.provider": "black",
  "python.testing.pytestEnabled": true,
  "python.testing.pytestArgs": ["tests"],
  "files.exclude": {
    "**/__pycache__": true,
    "**/*.pyc": true,
    "**/node_modules": true,
    "**/dist": true,
    "**/.git": true
  }
}
```

### 4.2 .vscode/extensions.json

```json
{
  "recommendations": [
    "Vue.volar",
    "Vue.vscode-typescript-vue-plugin",
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "ms-python.python",
    "ms-python.vscode-pylance",
    "ms-python.black-formatter",
    "ms-python.isort",
    "ms-azuretools.vscode-docker"
  ]
}
```

## 5. ESLint 配置

### 5.1 .eslintrc.cjs

```javascript
module.exports = {
  root: true,
  env: {
    node: true,
  },
  extends: [
    'plugin:vue/vue3-essential',
    'eslint:recommended',
    '@vue/eslint-config-typescript',
    '@vue/eslint-config-prettier/skip-formatting',
  ],
  parserOptions: {
    ecmaVersion: 'latest',
  },
  rules: {
    'vue/multi-word-component-names': 'off',
    'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
  },
};
```

### 5.2 .prettierrc

```json
{
  "semi": false,
  "singleQuote": true,
  "printWidth": 100,
  "trailingComma": "es5"
}
```

## 6. 开发命令速查

### 6.1 前端命令

```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产版本
npm run preview

# 代码检查
npm run lint

# 运行测试
npm run test
```

### 6.2 后端命令

```bash
cd backend

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt

# 启动开发服务器
uvicorn app.main:app --reload

# 数据库迁移
alembic revision --autogenerate -m "描述"
alembic upgrade head

# 运行测试
pytest

# 代码格式化
black .
isort .

# 代码检查
flake8 .
mypy .
```

### 6.3 Docker 命令

```bash
# 开发环境
docker-compose -f docker-compose.dev.yml up
docker-compose -f docker-compose.dev.yml down

# 生产环境
docker-compose up -d
docker-compose down

# 查看日志
docker-compose logs -f

# 重新构建
docker-compose build

# 进入容器
docker-compose exec backend bash
docker-compose exec frontend sh
```

## 7. 初始化脚本

### 7.1 数据库初始化脚本 (backend/scripts/init_db.py)

```python
#!/usr/bin/env python3
"""
数据库初始化脚本
"""
import asyncio
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker

from app.core.config import settings
from app.models.base import Base
from app.models import admin, room, user, mappool, bp_record, operation_log


async def init_db():
    """初始化数据库"""
    engine = create_async_engine(settings.DATABASE_URL, echo=True)
    async_session = sessionmaker(engine, class_=AsyncSession, expire_on_commit=False)

    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)

    await engine.dispose()
    print("数据库初始化完成！")


if __name__ == "__main__":
    asyncio.run(init_db())
```

### 7.2 填充初始数据脚本 (backend/scripts/seed_data.py)

```python
#!/usr/bin/env python3
"""
填充初始数据脚本
"""
import asyncio
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker
from passlib.context import CryptContext

from app.core.config import settings
from app.models.base import Base
from app.models import admin, mappool


pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")


async def seed_data():
    """填充初始数据"""
    engine = create_async_engine(settings.DATABASE_URL, echo=True)
    async_session = sessionmaker(engine, class_=AsyncSession, expire_on_commit=False)

    async with async_session() as session:
        # 创建默认管理员
        admin_user = admin.Admin(
            username="admin",
            password_hash=pwd_context.hash("admin123")
        )
        session.add(admin_user)

        # 创建默认地图池
        default_mappool = mappool.MapPoolConfig(
            name="默认地图池",
            map01_name="Mirage",
            map01_icon="/assets/images/maps/mirage.png",
            map02_name="Inferno",
            map02_icon="/assets/images/maps/inferno.png",
            map03_name="Dust2",
            map03_icon="/assets/images/maps/dust2.png",
            map04_name="Nuke",
            map04_icon="/assets/images/maps/nuke.png",
            map05_name="Anubis",
            map05_icon="/assets/images/maps/anubis.png",
            map06_name="Vertigo",
            map06_icon="/assets/images/maps/vertigo.png",
            map07_name="Ancient",
            map07_icon="/assets/images/maps/ancient.png",
            is_default=True
        )
        session.add(default_mappool)

        await session.commit()
        print("初始数据填充完成！")

    await engine.dispose()


if __name__ == "__main__":
    asyncio.run(seed_data())
```
