# CS2 地图 Ban Pick 工具 - 项目目录结构

## 1. 完整目录树

```
CS2-Map-Ban-Pick-Tool/
├── plans/                          # 架构设计文档
│   ├── 01-项目整体架构设计.md
│   ├── 02-数据库模型设计.md
│   ├── 03-后端API接口规范.md
│   ├── 04-前端页面结构和组件架构.md
│   └── 05-项目目录结构.md
│
├── frontend/                       # Vue.js 前端项目
│   ├── public/                     # 静态资源
│   │   ├── favicon.ico
│   │   └── logo.png
│   │
│   ├── src/
│   │   ├── assets/                 # 资源文件
│   │   │   ├── images/            # 图片
│   │   │   │   ├── default-team-icon.png
│   │   │   │   └── default-map-icon.png
│   │   │   ├── icons/             # 图标
│   │   │   └── styles/            # 全局样式
│   │   │       └── global.css
│   │   │
│   │   ├── components/             # 公共组件
│   │   │   ├── BPMapPolygon/      # 正七边形地图池组件
│   │   │   │   ├── MapCard.vue
│   │   │   │   └── index.vue
│   │   │   ├── ProgressBar/       # 进度条组件
│   │   │   │   ├── PhaseBar.vue
│   │   │   │   └── index.vue
│   │   │   ├── TeamDisplay/       # 队伍展示组件
│   │   │   │   ├── UserItem.vue
│   │   │   │   └── index.vue
│   │   │   ├── ChatBox/           # 聊天框组件
│   │   │   │   ├── MessageItem.vue
│   │   │   │   ├── MessageInput.vue
│   │   │   │   └── index.vue
│   │   │   ├── Timer/             # 计时器组件
│   │   │   │   └── index.vue
│   │   │   ├── MapCard/           # 地图卡片组件
│   │   │   │   └── index.vue
│   │   │   ├── ResultGrid/        # 结果展示组件
│   │   │   │   ├── ResultItem.vue
│   │   │   │   └── index.vue
│   │   │   └── common/            # 通用组件
│   │   │       ├── Button.vue
│   │   │       ├── Input.vue
│   │   │       ├── Modal.vue
│   │   │       └── Toast.vue
│   │   │
│   │   ├── views/                 # 页面视图
│   │   │   ├── JoinRoom.vue       # 加入房间页面
│   │   │   ├── SelectTeam.vue     # 选择队伍页面
│   │   │   ├── InputName.vue      # 输入名称页面
│   │   │   ├── WaitingRoom.vue    # 等待准备页面
│   │   │   ├── BPProcess.vue      # BP流程页面
│   │   │   ├── BPResult.vue       # BP结果页面
│   │   │   ├── AdminLogin.vue     # 管理员登录页面
│   │   │   └── AdminDashboard.vue # 管理员后台
│   │   │
│   │   ├── stores/                # Pinia 状态管理
│   │   │   ├── room.ts            # 房间状态
│   │   │   ├── user.ts            # 用户状态
│   │   │   ├── bp.ts              # BP流程状态
│   │   │   └── chat.ts            # 聊天状态
│   │   │
│   │   ├── services/              # API 服务
│   │   │   ├── api.ts             # REST API
│   │   │   ├── socket.ts          # WebSocket
│   │   │   └── index.ts
│   │   │
│   │   ├── types/                 # TypeScript 类型定义
│   │   │   ├── room.ts
│   │   │   ├── user.ts
│   │   │   ├── bp.ts
│   │   │   ├── chat.ts
│   │   │   └── index.ts
│   │   │
│   │   ├── utils/                 # 工具函数
│   │   │   ├── storage.ts         # 本地存储
│   │   │   ├── format.ts          # 格式化
│   │   │   ├── validation.ts      # 验证
│   │   │   └── constants.ts       # 常量
│   │   │
│   │   ├── router/                # 路由配置
│   │   │   └── index.ts
│   │   │
│   │   ├── App.vue                # 根组件
│   │   └── main.ts                # 入口文件
│   │
│   ├── tests/                     # 测试文件
│   │   ├── unit/                  # 单元测试
│   │   └── e2e/                   # 端到端测试
│   │
│   ├── index.html                 # HTML 模板
│   ├── vite.config.ts             # Vite 配置
│   ├── tailwind.config.js         # TailwindCSS 配置
│   ├── tsconfig.json              # TypeScript 配置
│   ├── tsconfig.node.json         # Node TypeScript 配置
│   ├── package.json               # 依赖配置
│   ├── package-lock.json
│   └── .env.example               # 环境变量示例
│
├── backend/                       # FastAPI 后端项目
│   ├── app/
│   │   ├── api/                   # API 路由
│   │   │   ├── __init__.py
│   │   │   ├── admin.py           # 管理员相关 API
│   │   │   ├── rooms.py           # 房间管理 API
│   │   │   ├── users.py           # 用户管理 API
│   │   │   ├── bp.py              # BP 流程 API
│   │   │   └── records.py         # BP 记录查询 API
│   │   │
│   │   ├── core/                  # 核心配置
│   │   │   ├── __init__.py
│   │   │   ├── config.py          # 配置文件
│   │   │   ├── security.py        # 安全相关（JWT、密码加密）
│   │   │   └── deps.py            # 依赖注入
│   │   │
│   │   ├── models/                # 数据库模型
│   │   │   ├── __init__.py
│   │   │   ├── base.py            # 基础模型
│   │   │   ├── admin.py
│   │   │   ├── room.py
│   │   │   ├── user.py
│   │   │   ├── mappool.py
│   │   │   ├── bp_record.py
│   │   │   └── operation_log.py
│   │   │
│   │   ├── schemas/               # Pydantic 模型
│   │   │   ├── __init__.py
│   │   │   ├── admin.py
│   │   │   ├── room.py
│   │   │   ├── user.py
│   │   │   ├── bp.py
│   │   │   └── record.py
│   │   │
│   │   ├── services/              # 业务逻辑
│   │   │   ├── __init__.py
│   │   │   ├── room_service.py
│   │   │   ├── bp_service.py
│   │   │   └── roll_service.py
│   │   │
│   │   ├── websocket/             # WebSocket 处理
│   │   │   ├── __init__.py
│   │   │   ├── manager.py         # 连接管理
│   │   │   ├── handlers.py        # 消息处理器
│   │   │   └── events.py          # 事件定义
│   │   │
│   │   ├── db/                    # 数据库
│   │   │   ├── __init__.py
│   │   │   ├── session.py         # 数据库会话
│   │   │   └── base.py            # 基础模型
│   │   │
│   │   ├── main.py                # 应用入口
│   │   └── __init__.py
│   │
│   ├── alembic/                   # 数据库迁移
│   │   ├── versions/
│   │   ├── env.py
│   │   ├── script.py.mako
│   │   └── README
│   │
│   ├── tests/                     # 测试文件
│   │   ├── __init__.py
│   │   ├── conftest.py
│   │   ├── test_api/
│   │   ├── test_services/
│   │   └── test_websocket/
│   │
│   ├── scripts/                   # 脚本
│   │   ├── init_db.py             # 初始化数据库
│   │   └── seed_data.py           # 填充初始数据
│   │
│   ├── requirements.txt           # Python 依赖
│   ├── requirements-dev.txt       # 开发依赖
│   ├── alembic.ini                # Alembic 配置
│   ├── Dockerfile                 # Docker 配置
│   ├── .env.example               # 环境变量示例
│   └── pyproject.toml             # 项目配置
│
├── nginx/                         # Nginx 配置
│   ├── nginx.conf                 # 主配置文件
│   └── ssl/                       # SSL 证书（生产环境）
│       ├── cert.pem
│       └── key.pem
│
├── docker-compose.yml             # Docker 编排配置
├── docker-compose.dev.yml         # 开发环境配置
├── .gitignore                     # Git 忽略文件
└── README.md                      # 项目说明
```

## 2. 文件说明

### 2.1 前端核心文件

| 文件 | 说明 |
|------|------|
| `src/main.ts` | 应用入口，初始化 Vue 应用、路由、Pinia |
| `src/App.vue` | 根组件 |
| `src/router/index.ts` | 路由配置 |
| `vite.config.ts` | Vite 构建配置 |
| `tailwind.config.js` | TailwindCSS 配置 |
| `package.json` | 前端依赖配置 |

### 2.2 后端核心文件

| 文件 | 说明 |
|------|------|
| `app/main.py` | FastAPI 应用入口 |
| `app/core/config.py` | 应用配置（数据库、JWT等） |
| `app/core/security.py` | 安全相关（JWT生成、密码加密） |
| `app/db/session.py` | 数据库会话管理 |
| `requirements.txt` | 生产环境依赖 |
| `alembic.ini` | 数据库迁移配置 |

### 2.3 Docker 配置文件

| 文件 | 说明 |
|------|------|
| `docker-compose.yml` | 生产环境 Docker 编排 |
| `docker-compose.dev.yml` | 开发环境 Docker 编排 |
| `backend/Dockerfile` | 后端 Docker 镜像构建 |
| `frontend/Dockerfile` | 前端 Docker 镜像构建 |
| `nginx/nginx.conf` | Nginx 反向代理配置 |

## 3. 创建目录的命令

### 3.1 创建所有目录

```bash
# 创建 plans 目录
mkdir -p plans

# 创建前端目录
mkdir -p frontend/public
mkdir -p frontend/src/{assets/{images,icons,styles},components/{BPMapPolygon,ProgressBar,TeamDisplay,ChatBox,Timer,MapCard,ResultGrid,common},views,stores,services,types,utils,router}
mkdir -p frontend/tests/{unit,e2e}

# 创建后端目录
mkdir -p backend/app/{api,core,models,schemas,services,websocket,db}
mkdir -p backend/alembic/versions
mkdir -p backend/tests/{test_api,test_services,test_websocket}
mkdir -p backend/scripts

# 创建 nginx 目录
mkdir -p nginx/ssl
```

### 3.2 初始化前端项目

```bash
cd frontend
npm create vite@latest . -- --template vue-ts
npm install
npm install pinia vue-router socket.io-client axios
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
```

### 3.3 初始化后端项目

```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install fastapi uvicorn sqlalchemy psycopg2-binary alembic python-jose passlib[bcrypt] python-multipart python-socketio
pip install -r requirements-dev.txt
```

## 4. 环境变量配置

### 4.1 前端环境变量 (.env)

```env
VITE_API_BASE_URL=http://localhost:8000/api
VITE_WS_BASE_URL=http://localhost:8000
```

### 4.2 后端环境变量 (.env)

```env
# 应用配置
APP_NAME=CS2 Map Ban Pick Tool
APP_VERSION=1.0.0
DEBUG=True

# 数据库配置
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/cs2_bp_tool

# JWT 配置
SECRET_KEY=your-secret-key-change-this-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=60

# CORS 配置
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# Redis 配置（可选，用于缓存）
REDIS_URL=redis://redis:6379/0
```

### 4.3 Docker Compose 环境变量 (.env)

```env
# PostgreSQL
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=cs2_bp_tool

# 后端
BACKEND_PORT=8000

# 前端
FRONTEND_PORT=3000

# Nginx
NGINX_PORT=80
NGINX_SSL_PORT=443
```

## 5. 开发命令

### 5.1 前端开发命令

```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产版本
npm run preview

# 运行测试
npm run test

# 代码检查
npm run lint
```

### 5.2 后端开发命令

```bash
cd backend

# 安装依赖
pip install -r requirements.txt

# 启动开发服务器
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# 数据库迁移
alembic revision --autogenerate -m "Initial migration"
alembic upgrade head

# 运行测试
pytest

# 代码格式化
black .
isort .
```

### 5.3 Docker 命令

```bash
# 启动所有服务（开发环境）
docker-compose -f docker-compose.dev.yml up

# 启动所有服务（生产环境）
docker-compose up -d

# 停止所有服务
docker-compose down

# 查看日志
docker-compose logs -f

# 重新构建
docker-compose build

# 进入容器
docker-compose exec backend bash
docker-compose exec frontend sh
```
